<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>Vokabeln</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <link href="styles.css" rel="stylesheet"> <!-- Sidebar-Styles -->
</head>
<body>
  <!-- Sidebar -->
  <div class="sidebar">
    <h2><i class="bi bi-list-stars"></i> Navigation</h2>
    <ul>
        <li><a href="index.html" ><i class="bi bi-house-door-fill"></i> Home</a></li>
        <li><a href="favorite.html" class="active"><i class="bi bi-star-fill"></i> Vokabeln</a></li>
        <li><a href="quiz.html"><i class="bi bi-patch-question-fill"></i> Vokabeln</a></li>
    </ul>
  </div>

  <!-- Hauptinhalt -->
  <div class="container mt-4">
    <div class="d-flex justify-content-between align-items-center mb-3">
      <h1><i class="bi bi-bookmark-check-fill"></i> Gespeicherte Vokabeln</h1>
      <button class="btn btn-danger" onclick="deleteAllVocab()">
        <i class="bi bi-trash3-fill"></i> Alle löschen
      </button>
    </div>

    <ul id="vocabList" class="list-group"></ul>
  </div>

  <!-- JS -->
  <script>
    fetch("http://127.0.0.1:5000/get-vocab")
      .then(res => res.json())
      .then(data => {
        const list = document.getElementById("vocabList");
        data.forEach(entry => {
          const item = document.createElement("li");
          item.className = "list-group-item";

          item.innerHTML = `
            <div class="d-flex justify-content-between align-items-start">
              <div>
                <h5 class="mb-1"><b>${entry.original_word}</b> → ${entry.translated_word}</h5>
                <p class="mb-1 text-muted">${entry.original_sentence}</p>
              </div>
              <button class="btn btn-sm btn-outline-danger" onclick="deleteVocab(${entry.id}, this)" title="Löschen">
                <i class="bi bi-trash"></i>
              </button>
            </div>
          `;
          list.appendChild(item);
        });
      });

    function deleteVocab(id, button) {
      if (!confirm("Diese Vokabel wirklich löschen?")) return;

      fetch(`http://127.0.0.1:5000/delete-vocab/${id}`, {
        method: "DELETE"
      })
      .then(res => res.json())
      .then(data => {
        if (data.status === "success") {
          const listItem = button.closest("li");
          if (listItem) listItem.remove();
        } else {
          alert("❌ Fehler beim Löschen: " + data.message);
        }
      })
      .catch(err => {
        alert("❌ Netzwerkfehler beim Löschen.");
        console.error(err);
      });
    }

    function deleteAllVocab() {
      if (!confirm("⚠️ Möchtest du wirklich alle Vokabeln löschen?")) return;

      fetch("http://127.0.0.1:5000/delete-all-vocab", {
        method: "DELETE"
      })
      .then(res => res.json())
      .then(data => {
        if (data.status === "success") {
          document.getElementById("vocabList").innerHTML = "";
          alert("✅ Alle Vokabeln wurden gelöscht.");
        } else {
          alert("❌ Fehler: " + data.message);
        }
      })
      .catch(err => {
        alert("❌ Netzwerkfehler beim Löschen.");
        console.error(err);
      });
    }
  </script>
</body>
</html>
